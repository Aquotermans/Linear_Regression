#Regression lineaire en python
#y = ax + b
import pandas as pd
import matplotlib.pyplot as plt
plt.style.use('seaborn-whitegrid')
import numpy as np

a = 0
b = 0
c = 0
d = 0

#Importation du fichier excel
xls = pd.read_excel (r'C:\Users\Arno\Desktop\Test_python.xls')
#print(xls)

#Longueur du tableau
taille = len(xls)
#print('Taille du tableau ', taille)

#Calcule de moyenne de la colone X et de la colone Y
moyenne_x = sum(xls.iloc[:,0])/taille
moyenne_y = sum(xls.iloc[:,1])/taille


#Nominateur de a (y = ax + b)
#(Xi - Xmoyenne)*(Yi-Ymoyenne)
for i in range(taille):
    a = xls.at[i,0] - moyenne_x
    b = xls.at[i,1] - moyenne_y
    c += a*b
    
#Dénomitaeur de a
#(Xi-Xmoyenne)^2    
for i in range(taille):
    d += (xls.at[i,0] - moyenne_x)**2
    
#Definir a
a = c/d

#Définir B
b = moyenne_y - a*moyenne_x

x = []
y = []

for i in range(taille):
    x.append(xls.at[i,0])
    y.append(xls.at[i,1])

   
#'o' signie qu'on plot des points
plt.plot(x,y,'o')

#Tableau de la regression
xr = np.arange(xls[0].min(),xls[0].max(),(xls[0].max()-xls[0].min())/taille)
yr = a * xr + b
plt.plot(xr,yr)
